pip install mysql-connector-python

import mysql.connector

config = {
  'user': 'loansanalyst',
  'password': 'EDALoanAnalyst',
  'host': 'eda-projects.cq2e8zno855e.eu-west-1.rds.amazonaws.com',
  'database': 'payments',
  'port': '5432'
}

cnx = mysql.connector.connect(**config)
cursor = cnx.cursor()

# Execute a query
query = ("SELECT * FROM your_table")
cursor.execute(query)

# Fetch the results
for result in cursor:
    print(result)

# Close the connection
cursor.close()
cnx.close()

class RDSDatabaseConnector:
    def __init__(self, credentials: dict):
        self.host = credentials['eda-projects.cq2e8zno855e.eu-west-1.rds.amazonaws.com']
        self.username = credentials['loansanalyst']
        self.password = credentials['EDALoanAnalyst']
        self.database = credentials['payments']
        self.port = credentials['5432']

        from sqlalchemy import create_engine

class RDSDatabaseConnector:
    def __init__(self, credentials: dict):
        self.host = credentials['eda-projects.cq2e8zno855e.eu-west-1.rds.amazonaws.com']
        self.username = credentials['loansanalyst']
        self.password = credentials['EDALoanAnalyst']
        self.database = credentials['payments']
        self.port = credentials['5432']
 def initialize_engine(self):
      engine_url = f"postgresql://{self.username}:{self.password}@{self.host}:{self.port}/{self.database}"
      engine = create_engine(engine_url)
      return engine
      import pandas as pd
from sqlalchemy import create_engine

class RDSDatabaseConnector:
    def __init__(self, credentials: dict):
        self.host = credentials['eda-projects.cq2e8zno855e.eu-west-1.rds.amazonaws.com']
        self.username = credentials['loansanalyst']
        self.password = credentials['EDALoanAnalyst']
        self.database = credentials['payments']
        self.port = credentials['5432']
    def initialize_engine(self):
        engine_url = f"postgresql://{self.username}:{self.password}@{self.host}:{self.port}/{self.database}"
        engine = create_engine(engine_url)
        return engine

    def extract_data(self):
        engine = self.initialize_engine()
        query = "SELECT * FROM loan_payments"
        df = pd.read_sql(query, engine)
        return df

        
        import pandas as pd
def save_to_csv(df, file_path):
    df.to_csv(file_path, index=False)

